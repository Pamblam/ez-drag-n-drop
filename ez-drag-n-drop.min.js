/*! ez-drag-n-drop - v0.0.5 */
class EZDnD_Draggable{constructor(e,t,n,s=null){this.element=e,this.anchor=t,this.containers=Array.isArray(n)?n:[n],this.placeholder=this.normalizePlaceholderInput(s),this.validateClassParameters(),this.isDragging=!1,this.elementClone=!1,this.mouseOffset={x:0,y:0},this.cssDisplayValue=this.element.style.display||null,this.anchorCursor=this.anchor.style.cursor||null,this.bodyCursor=document.body.style.cursor||null,this.currentAbsPos={x:0,y:0},this.newElementPosition=null,this.boundOnAnchorMousedown=this.onAnchorMousedown.bind(this),this.boundOnMouseReleasethis=this.onMouseRelease.bind(this),this.boundOnMouseMove=this.onMouseMove.bind(this),this.boundOnMouseOverAnchor=this.onMouseOverAnchor.bind(this),this.boundOnMouseOutAnchor=this.onMouseOutAnchor.bind(this),this.bind()}destroy(){this.unbind()}unbind(){this.anchor.removeEventListener("mousedown",this.boundOnAnchorMousedown),document.removeEventListener("mouseup",this.boundOnMouseReleasethis),document.removeEventListener("mousemove",this.boundOnMouseMove),this.anchor.removeEventListener("mouseover",this.boundOnMouseOverAnchor),this.anchor.removeEventListener("mouseout",this.boundOnMouseOutAnchor),this.onMouseRelease()}bind(){this.anchor.addEventListener("mousedown",this.boundOnAnchorMousedown),document.addEventListener("mouseup",this.boundOnMouseReleasethis),document.addEventListener("mousemove",this.boundOnMouseMove),this.anchor.addEventListener("mouseover",this.boundOnMouseOverAnchor),this.anchor.addEventListener("mouseout",this.boundOnMouseOutAnchor)}normalizePlaceholderInput(e){if(e instanceof HTMLElement)return e;if("string"==typeof e){var t=document.createElement("div");t.innerHTML=e;var n=[...t.children];return n.length?n[0]:null}return null}onMouseOverAnchor(){this.anchor.style.cursor="grab"}onMouseOutAnchor(){this.anchor.style.cursor=this.anchorCursor}validateClassParameters(){if(["element","anchor"].forEach(e=>{if(!(this[e]instanceof HTMLElement))throw new Error(e+" must be instance of HTMLElement")}),this.containers.forEach(e=>{if(!(e instanceof HTMLElement))throw new Error("containers must be instances of HTMLElement")}),!this.isInContainer(this.element))throw new Error("element must be contained within container.");if(!this.element.contains(this.anchor))throw new Error("anchor must be contained within element.")}isInContainer(e){var t=!1;return this.containers.forEach(n=>{n.contains(e)&&(t=!0)}),t}onMouseRelease(){var e=!!this.isDragging,t=!!this.newElementPosition;if(this.isDragging=!1,this.elementClone&&this.elementClone.remove(),this.mouseOffset={x:0,y:0},this.currentAbsPos={x:0,y:0},this.newElementPosition&&(this.newElementPosition.ele.insertAdjacentElement(this.newElementPosition.pos,this.element),this.placeholder&&this.placeholder.remove()),document.body.style.cursor=this.bodyCursor,this.anchor.style.cursor=this.anchorCursor,this.newElementPosition=null,this.element.style.display=this.cssDisplayValue,e)if(t){var n=new CustomEvent("dnd-completed",{detail:this,bubbles:!0});this.element.dispatchEvent(n)}else{n=new CustomEvent("dnd-canceled",{detail:this,bubbles:!0});this.element.dispatchEvent(n)}}onAnchorMousedown(e){e.preventDefault(),this.isDragging=!0,this.calculateMouseOffset(e),this.elementClone=this.cloneElement(),this.cssDisplayValue=this.element.style.display||null,this.element.style.display="none",document.body.style.cursor="grabbing";var t=new CustomEvent("dnd-started",{detail:this,bubbles:!0});this.element.dispatchEvent(t)}getNewElementPosition(){var e=null,t=this.calculateElementCenterPos(this.elementClone);if(this.containers.forEach(n=>{var{top:s,left:o,right:i,bottom:r}=n.getBoundingClientRect();s+=scrollY,r+=scrollY,o+=scrollX,i+=scrollX;const l=t.x>=o&&t.x<=i,h=t.y>=s&&t.y<=r;l&&h&&(e=n)}),!e)return null;var n,s,o,i=[...e.children];return i.length?(i.forEach(e=>{var i=null,r=this.calculateElementCenterPos(e),l=Math.hypot(r.x-t.x,r.y-t.y);i=t.y<r.y?"beforebegin":t.y>r.y?"afterend":t.x>r.x?"afterend":"beforebegin",(!o||l<o)&&(o=l,s=e,n=i)}),{pos:n,ele:s}):{pos:"afterbegin",ele:e}}calculateElementCenterPos(e){var{top:t,left:n,width:s,height:o}=e.getBoundingClientRect();return t+=scrollY,{x:(n+=scrollX)+s/2,y:t+o/2}}onMouseMove(e){if(!1!==this.isDragging){var t=new CustomEvent("dnd-dragging",{detail:this,bubbles:!0});this.element.dispatchEvent(t),this.currentAbsPos={x:e.pageX-this.mouseOffset.x,y:e.pageY-this.mouseOffset.y},this.elementClone.style.top=this.currentAbsPos.y+"px",this.elementClone.style.left=this.currentAbsPos.x+"px",this.newElementPosition=this.getNewElementPosition(e),this.placeholder&&(this.newElementPosition?this.newElementPosition.ele.insertAdjacentElement(this.newElementPosition.pos,this.placeholder):this.placeholder.remove())}}calculateMouseOffset(e){var t=this.element.getBoundingClientRect(),n=e.pageX-(t.left+scrollX),s=e.pageY-(t.top+scrollY);this.mouseOffset={x:n,y:s}}cloneElement(){const e=(e,o)=>{var i=(s=void 0===(t=e).currentStyle?document.defaultView.getComputedStyle(t,null):t.currentStyle,n?s[n]:s);for(var r in i)if("string"==typeof r&&"cssText"!==r&&!/\d/.test(r))try{o.style[r]=i[r],"font"==r&&(o.style.fontSize=i.fontSize)}catch(e){}};var t,n,s,o=this.element.cloneNode(!0);document.body.append(o),e(this.element,o);const i=this.element.getElementsByTagName("*"),r=o.getElementsByTagName("*");for(let t=i.length;t--;){e(i[t],r[t])}var l=this.element.getBoundingClientRect();return this.currentAbsPos={x:l.left+scrollX,y:l.top+scrollY},o.style.position="absolute",o.style.top=this.currentAbsPos.y+"px",o.style.left=this.currentAbsPos.x+"px",o}}class EZDnD_Group{constructor(e,t,n,s=null){this.draggables=[];const o=[...document.querySelectorAll(n)];[...document.querySelectorAll(e)].forEach(e=>{const n=e.querySelector(t);this.draggables.push(new EZDnD_Draggable(e,n,o,s))})}destroy(){this.unbind()}unbind(){this.draggables.forEach(e=>e.unbind())}}